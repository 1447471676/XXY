<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script>
        window.onload = function () {
            let oBtn = document.getElementById("show");
            let oBox = document.getElementById("box");

            /*
            (不节流)  当我点击时，每点击一次，
            数量增加一，点击越快，增加越快，
            */
            // oBtn.onclick = function () {
            //     oBox.innerText = parseInt(oBox.innerText) + 1
            // }


            /*
             (节流)
             handle:buy函数
             wait:规定一秒钟内只能执行一次
             (想要在规定时间内只能执行一次，比如1秒内只能执行一次.无论你点击多少次 如下：)
             */
            function throttle(handle,wait) {
                     let lastTime=0;
                     return function (e) {//暴露出去的函数
                         let nowTime=new Date().getTime()
                         if (nowTime - lastTime > wait){
                         handle();
                         lastTime = nowTime;
                         }
                     }
                 }
            function buy() {
                oBox.innerText=parseInt(oBox.innerText)+1
            }
            oBtn.onclick=throttle(buy,1000)


            /*
            (不防抖）
            用户无论输入多快，都会发出请求，
            从而去加载服务器资源，对性能有很大的影响.
             */
            // let opt = document.getElementById("ipt");
            // function ajax() {
            //     console.log(this.value)
            // }
            // opt.oninput = ajax;


            /*
            （防抖）
            可以解决多次请求的问题，对性能有很大的提高
             */
            let opt=document.getElementById("ipt");
            let time =null;
            function debouce(handle,delay) {
                let time=null;
                return function () {
                    let self=this,arg=arguments;
                    clearTimeout(time);
                    time=setTimeout(function () {
                        handle.apply(self,arg);//this绑定
                    },delay)
                }
            }
            function ajax(e) {
            console.log(e,this.value)

            }
            opt.oninput=debouce(ajax,1000)//1s后发出请求
        }
    </script>
</head>
<body>
<button id="show">抢购</button>
<div id="box">0</div>
<input type="" id="ipt">
</body>
</html>